function T = Calc_T_from_h_X_LiBrSol_Patek(h,X_mol_LiBr)
% ---------------------------------------------------------------------- %
% Calc_T_from_h_X_LiBrSol_Patek
% Uses coefficients and formula obtained from Patek 2006
% Input:
%       -   Molar enthalpy of solution                            [J/mol/K]
%       -   Molar concentration X of LiBr in Solution                   [-]
% Output:
%       -   Temperature of solution                                     [K]
% ---------------------------------------------------------------------- %
if nargin<2||isempty(h),error('Input Argument:Enthalpy missing');end
if nargin<1||isempty(X_mol_LiBr),error('Input Argument:Concentration missing');end
%% Constants
T_c = 647.096;              %[K]
h_c = 37548.5;              %[J/mol]
T_0 = 221;                  %[K]
% Table 7
Koef_a = [  2.27431     *   10^0;
            -7.99511    *   10^0;
            3.85239     *   10^2;
            -1.63940    *   10^4;
            -4.22562    *   10^2;          
            1.13314     *   10^-1;
            -8.33474    *   10^0;
            -1.73833    *   10^4;
            6.49763     *   10^0;
            3.24552     *   10^3;
            -1.34643    *   10^4;
            3.99322     *   10^4;
            -2.58877    *   10^5;
            -1.93046    *   10^-3;
            2.80616     *   10^0;
            -4.04479    *   10^1;
            1.45342     *   10^2;
            -2.74873    *   10^0;
            -4.49743    *   10^2;
            -1.21794    *   10^1;
            -5.83739    *   10^-3;
            2.33910     *   10^-1;
            3.41888     *   10^-1;
            8.85259     *   10^0;
            -1.78731    *   10^1;
            7.35179     *   10^-2;
            -1.79430    *   10^-4;
            1.84261     *   10^-3;
            -6.24282    *   10^-3;
            6.84765     *   10^-3];
Koef_t = [0;0;0;0;0;1;1;1;2;2;2;2;2;3;3;3;3;3;3;3;4;4;4;4;4;4;5;5;5;5];
Koef_n = [0;1;6;6;2;0;0;4;0;4;5;5;6;0;3;5;7;0;3;1;0;4;2;6;7;0;0;1;2;3];
Koef_m = [1;1;2;3;6;1;3;5;4;5;5;6;6;1;2;2;2;5;6;7;1;1;2;2;2;3;1;1;1;1];
% Table 14
Koef_beta = [1/3;2/3;5/6;21/6];
Koef_alpha = [  -4.37196    *   10^-1;
                3.03440     *   10^-1;
                -1.29582    *   10^0;
                -1.76410    *   10^-1];
%% Calculation
fun = @(T)(1-X_mol_LiBr)*h_c*(1+...
    Koef_alpha(1)*(1-(T/T_c))^Koef_beta(1)+...
    Koef_alpha(2)*(1-(T/T_c))^Koef_beta(2)+...
    Koef_alpha(3)*(1-(T/T_c))^Koef_beta(3)+...
    Koef_alpha(4)*(1-(T/T_c))^Koef_beta(4))+...
    h_c*...
    (Koef_a(1)*X_mol_LiBr^Koef_m(1)*(0.4-X_mol_LiBr)^Koef_n(1)*(T_c/(T-T_0))^Koef_t(1)+...
    Koef_a(2)*X_mol_LiBr^Koef_m(2)*(0.4-X_mol_LiBr)^Koef_n(2)*(T_c/(T-T_0))^Koef_t(2)+...
    Koef_a(3)*X_mol_LiBr^Koef_m(3)*(0.4-X_mol_LiBr)^Koef_n(3)*(T_c/(T-T_0))^Koef_t(3)+...
    Koef_a(4)*X_mol_LiBr^Koef_m(4)*(0.4-X_mol_LiBr)^Koef_n(4)*(T_c/(T-T_0))^Koef_t(4)+...
    Koef_a(5)*X_mol_LiBr^Koef_m(5)*(0.4-X_mol_LiBr)^Koef_n(5)*(T_c/(T-T_0))^Koef_t(5)+...
    Koef_a(6)*X_mol_LiBr^Koef_m(6)*(0.4-X_mol_LiBr)^Koef_n(6)*(T_c/(T-T_0))^Koef_t(6)+...
    Koef_a(7)*X_mol_LiBr^Koef_m(7)*(0.4-X_mol_LiBr)^Koef_n(7)*(T_c/(T-T_0))^Koef_t(7)+...
    Koef_a(8)*X_mol_LiBr^Koef_m(8)*(0.4-X_mol_LiBr)^Koef_n(8)*(T_c/(T-T_0))^Koef_t(8)+...
    Koef_a(9)*X_mol_LiBr^Koef_m(9)*(0.4-X_mol_LiBr)^Koef_n(9)*(T_c/(T-T_0))^Koef_t(9)+...
    Koef_a(10)*X_mol_LiBr^Koef_m(10)*(0.4-X_mol_LiBr)^Koef_n(10)*(T_c/(T-T_0))^Koef_t(10)+...
    Koef_a(11)*X_mol_LiBr^Koef_m(11)*(0.4-X_mol_LiBr)^Koef_n(11)*(T_c/(T-T_0))^Koef_t(11)+...
    Koef_a(12)*X_mol_LiBr^Koef_m(12)*(0.4-X_mol_LiBr)^Koef_n(12)*(T_c/(T-T_0))^Koef_t(12)+...
    Koef_a(13)*X_mol_LiBr^Koef_m(13)*(0.4-X_mol_LiBr)^Koef_n(13)*(T_c/(T-T_0))^Koef_t(13)+...
    Koef_a(14)*X_mol_LiBr^Koef_m(14)*(0.4-X_mol_LiBr)^Koef_n(14)*(T_c/(T-T_0))^Koef_t(14)+...
    Koef_a(15)*X_mol_LiBr^Koef_m(15)*(0.4-X_mol_LiBr)^Koef_n(15)*(T_c/(T-T_0))^Koef_t(15)+...
    Koef_a(16)*X_mol_LiBr^Koef_m(16)*(0.4-X_mol_LiBr)^Koef_n(16)*(T_c/(T-T_0))^Koef_t(16)+...
    Koef_a(17)*X_mol_LiBr^Koef_m(17)*(0.4-X_mol_LiBr)^Koef_n(17)*(T_c/(T-T_0))^Koef_t(17)+...
    Koef_a(18)*X_mol_LiBr^Koef_m(18)*(0.4-X_mol_LiBr)^Koef_n(18)*(T_c/(T-T_0))^Koef_t(18)+...
    Koef_a(19)*X_mol_LiBr^Koef_m(19)*(0.4-X_mol_LiBr)^Koef_n(19)*(T_c/(T-T_0))^Koef_t(19)+...
    Koef_a(20)*X_mol_LiBr^Koef_m(20)*(0.4-X_mol_LiBr)^Koef_n(20)*(T_c/(T-T_0))^Koef_t(20)+...
    Koef_a(21)*X_mol_LiBr^Koef_m(21)*(0.4-X_mol_LiBr)^Koef_n(21)*(T_c/(T-T_0))^Koef_t(21)+...
    Koef_a(22)*X_mol_LiBr^Koef_m(22)*(0.4-X_mol_LiBr)^Koef_n(22)*(T_c/(T-T_0))^Koef_t(22)+...
    Koef_a(23)*X_mol_LiBr^Koef_m(23)*(0.4-X_mol_LiBr)^Koef_n(23)*(T_c/(T-T_0))^Koef_t(23)+...
    Koef_a(24)*X_mol_LiBr^Koef_m(24)*(0.4-X_mol_LiBr)^Koef_n(24)*(T_c/(T-T_0))^Koef_t(24)+...
    Koef_a(25)*X_mol_LiBr^Koef_m(25)*(0.4-X_mol_LiBr)^Koef_n(25)*(T_c/(T-T_0))^Koef_t(25)+...
    Koef_a(26)*X_mol_LiBr^Koef_m(26)*(0.4-X_mol_LiBr)^Koef_n(26)*(T_c/(T-T_0))^Koef_t(26)+...
    Koef_a(27)*X_mol_LiBr^Koef_m(27)*(0.4-X_mol_LiBr)^Koef_n(27)*(T_c/(T-T_0))^Koef_t(27)+...
    Koef_a(28)*X_mol_LiBr^Koef_m(28)*(0.4-X_mol_LiBr)^Koef_n(28)*(T_c/(T-T_0))^Koef_t(28)+...
    Koef_a(29)*X_mol_LiBr^Koef_m(29)*(0.4-X_mol_LiBr)^Koef_n(29)*(T_c/(T-T_0))^Koef_t(29)+...
    Koef_a(30)*X_mol_LiBr^Koef_m(30)*(0.4-X_mol_LiBr)^Koef_n(30)*(T_c/(T-T_0))^Koef_t(30))-h;
T = fzero(fun,400);
end
