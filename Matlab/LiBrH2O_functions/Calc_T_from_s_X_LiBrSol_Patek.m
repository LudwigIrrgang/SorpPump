function T = Calc_T_from_s_X_LiBrSol_Patek(s,X_mol_LiBr)
% ---------------------------------------------------------------------- %
% Calc_T_from_s_X_LiBrSol_Patek
% Uses coefficients and formula obtained from Patek and Klomfar 2006
% DOI: 10.1016/j.ijrefrig.2005.10.007
% Input:
%       -   Molar enthalpy of solution                              [J/mol]
%       -   Molar Concentration X of LiBr in Solution                   [-]
% Output:
%       -   Temperature of solution                                     [K]
% ---------------------------------------------------------------------- %
if nargin<2||isempty(s),error('Input Argument:Enthalpy missing');end
if nargin<1||isempty(X_mol_LiBr),error('Input Argument:Concentration missing');end
%% Constants
T_c = 647.096;              %[K]
s_c = 79.3933;              %[J/molK]
T_0 = 221;                  %[K]
% Table 8
Koef_a = [  1.53091     *   10^0;
            -4.52564    *   10^0;
            6.98302     *   10^2;
            -2.1666     *   10^4;
            -1.47533    *   10^3;
            8.47012     *   10^-2;
            -6.59523    *   10^0;
            -2.95331    *   10^4;
            9.56314     *   10^-3;
            -1.88679    *   10^-1;
            9.31752     *   10^0;
            5.78104     *   10^0;
            1.38931     *   10^4;
            -1.71762    *   10^4;
            4.15108     *   10^2;
            -5.55647    *   10^4;
            -4.23409    *   10^-3;
            3.05242     *   10^1;
            -1.67620    *   10^0;
            1.48283     *   10^1;
            3.03055     *   10^-3;
            -4.01810    *   10^-2;
            1.49252     *   10^-1;
            2.59240     *   10^0;
            -1.77421    *   10^-1;
            -6.99650    *   10^-5;
            6.05007     *   10^-4;
            -1.65228    *   10^-3;
            1.22966     *   10^-3];
Koef_t = [0;0;0;0;0;1;1;1;2;2;2;2;2;2;2;2;3;3;3;3;4;4;4;4;4;5;5;5;5];
Koef_n = [0;1;6;6;2;0;0;4;0;0;4;0;4;5;2;5;0;4;0;1;0;2;4;7;1;0;1;2;3];
Koef_m = [1;1;2;3;6;1;3;5;1;2;2;4;5;5;6;6;1;3;5;7;1;1;1;2;3;1;1;1;1];
% Table 15
Koef_beta = [1/3;1;8/3;8];
Koef_alpha = [  -3.34112    *   10^-1;
                -8.47987    *   10^-1;
                -9.11980    *   10^-1;
                -1.64046    *   10^0];
%% Calculation
fun = @(T)(1-X_mol_LiBr)*s_c*(1+...
    Koef_alpha(1)*(1-(T/T_c))^Koef_beta(1)+...
    Koef_alpha(2)*(1-(T/T_c))^Koef_beta(2)+...
    Koef_alpha(3)*(1-(T/T_c))^Koef_beta(3)+...
    Koef_alpha(4)*(1-(T/T_c))^Koef_beta(4))+...
    s_c*...
    (Koef_a(1)*X_mol_LiBr^Koef_m(1)*(0.4-X_mol_LiBr)^Koef_n(1)*(T_c/(T-T_0))^Koef_t(1)+...
    Koef_a(2)*X_mol_LiBr^Koef_m(2)*(0.4-X_mol_LiBr)^Koef_n(2)*(T_c/(T-T_0))^Koef_t(2)+...
    Koef_a(3)*X_mol_LiBr^Koef_m(3)*(0.4-X_mol_LiBr)^Koef_n(3)*(T_c/(T-T_0))^Koef_t(3)+...
    Koef_a(4)*X_mol_LiBr^Koef_m(4)*(0.4-X_mol_LiBr)^Koef_n(4)*(T_c/(T-T_0))^Koef_t(4)+...
    Koef_a(5)*X_mol_LiBr^Koef_m(5)*(0.4-X_mol_LiBr)^Koef_n(5)*(T_c/(T-T_0))^Koef_t(5)+...
    Koef_a(6)*X_mol_LiBr^Koef_m(6)*(0.4-X_mol_LiBr)^Koef_n(6)*(T_c/(T-T_0))^Koef_t(6)+...
    Koef_a(7)*X_mol_LiBr^Koef_m(7)*(0.4-X_mol_LiBr)^Koef_n(7)*(T_c/(T-T_0))^Koef_t(7)+...
    Koef_a(8)*X_mol_LiBr^Koef_m(8)*(0.4-X_mol_LiBr)^Koef_n(8)*(T_c/(T-T_0))^Koef_t(8)+...
    Koef_a(9)*X_mol_LiBr^Koef_m(9)*(0.4-X_mol_LiBr)^Koef_n(9)*(T_c/(T-T_0))^Koef_t(9)+...
    Koef_a(10)*X_mol_LiBr^Koef_m(10)*(0.4-X_mol_LiBr)^Koef_n(10)*(T_c/(T-T_0))^Koef_t(10)+...
    Koef_a(11)*X_mol_LiBr^Koef_m(11)*(0.4-X_mol_LiBr)^Koef_n(11)*(T_c/(T-T_0))^Koef_t(11)+...
    Koef_a(12)*X_mol_LiBr^Koef_m(12)*(0.4-X_mol_LiBr)^Koef_n(12)*(T_c/(T-T_0))^Koef_t(12)+...
    Koef_a(13)*X_mol_LiBr^Koef_m(13)*(0.4-X_mol_LiBr)^Koef_n(13)*(T_c/(T-T_0))^Koef_t(13)+...
    Koef_a(14)*X_mol_LiBr^Koef_m(14)*(0.4-X_mol_LiBr)^Koef_n(14)*(T_c/(T-T_0))^Koef_t(14)+...
    Koef_a(15)*X_mol_LiBr^Koef_m(15)*(0.4-X_mol_LiBr)^Koef_n(15)*(T_c/(T-T_0))^Koef_t(15)+...
    Koef_a(16)*X_mol_LiBr^Koef_m(16)*(0.4-X_mol_LiBr)^Koef_n(16)*(T_c/(T-T_0))^Koef_t(16)+...
    Koef_a(17)*X_mol_LiBr^Koef_m(17)*(0.4-X_mol_LiBr)^Koef_n(17)*(T_c/(T-T_0))^Koef_t(17)+...
    Koef_a(18)*X_mol_LiBr^Koef_m(18)*(0.4-X_mol_LiBr)^Koef_n(18)*(T_c/(T-T_0))^Koef_t(18)+...
    Koef_a(19)*X_mol_LiBr^Koef_m(19)*(0.4-X_mol_LiBr)^Koef_n(19)*(T_c/(T-T_0))^Koef_t(19)+...
    Koef_a(20)*X_mol_LiBr^Koef_m(20)*(0.4-X_mol_LiBr)^Koef_n(20)*(T_c/(T-T_0))^Koef_t(20)+...
    Koef_a(21)*X_mol_LiBr^Koef_m(21)*(0.4-X_mol_LiBr)^Koef_n(21)*(T_c/(T-T_0))^Koef_t(21)+...
    Koef_a(22)*X_mol_LiBr^Koef_m(22)*(0.4-X_mol_LiBr)^Koef_n(22)*(T_c/(T-T_0))^Koef_t(22)+...
    Koef_a(23)*X_mol_LiBr^Koef_m(23)*(0.4-X_mol_LiBr)^Koef_n(23)*(T_c/(T-T_0))^Koef_t(23)+...
    Koef_a(24)*X_mol_LiBr^Koef_m(24)*(0.4-X_mol_LiBr)^Koef_n(24)*(T_c/(T-T_0))^Koef_t(24)+...
    Koef_a(25)*X_mol_LiBr^Koef_m(25)*(0.4-X_mol_LiBr)^Koef_n(25)*(T_c/(T-T_0))^Koef_t(25)+...
    Koef_a(26)*X_mol_LiBr^Koef_m(26)*(0.4-X_mol_LiBr)^Koef_n(26)*(T_c/(T-T_0))^Koef_t(26)+...
    Koef_a(27)*X_mol_LiBr^Koef_m(27)*(0.4-X_mol_LiBr)^Koef_n(27)*(T_c/(T-T_0))^Koef_t(27)+...
    Koef_a(28)*X_mol_LiBr^Koef_m(28)*(0.4-X_mol_LiBr)^Koef_n(28)*(T_c/(T-T_0))^Koef_t(28)+...
    Koef_a(29)*X_mol_LiBr^Koef_m(29)*(0.4-X_mol_LiBr)^Koef_n(29)*(T_c/(T-T_0))^Koef_t(29))-s;
T = fzero(fun,400);
end
